{% extends 'index.html' %}
    {% block content %}
    <div class="main-ask pb-5">
        <div class="mt-4">
            <div class="author">
                <svg width="35px" height="40px" id="Layer_2" enable-background="new 0 0 64 64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><g><g><path d="m9.198 45.492c-.094 0-.19-.014-.285-.041-.529-.158-.831-.715-.673-1.244 2.277-7.654 11.102-10.652 16.158-11.76.537-.117 1.072.223 1.19.764.118.539-.224 1.072-.763 1.189-4.627 1.014-12.685 3.707-14.67 10.377-.128.436-.525.715-.957.715z"/></g><g><path d="m54.801 45.492c-.432 0-.829-.279-.959-.715-1.976-6.648-10.04-9.355-14.672-10.377-.539-.119-.88-.652-.761-1.191s.645-.881 1.192-.762c5.061 1.117 13.89 4.129 16.158 11.76.157.529-.145 1.086-.674 1.244-.095.028-.19.041-.284.041z"/></g><g><path d="m32.051 37.328c-4.141 0-8.038-2.182-10.171-5.691-2.569-4.229-2.163-9.848.988-13.664 2.22-2.689 5.654-4.295 9.188-4.295 1.38 0 2.73.238 4.012.707 4.645 1.701 7.766 6.166 7.766 11.115 0 5.596-3.975 10.473-9.45 11.592-.765.156-1.55.236-2.333.236zm.005-21.65c-2.942 0-5.801 1.334-7.645 3.568-2.618 3.172-2.956 7.84-.822 11.352 1.772 2.918 5.016 4.73 8.462 4.73.649 0 1.299-.066 1.932-.195 4.476-.916 7.851-5.057 7.851-9.633 0-4.049-2.653-7.846-6.453-9.236-1.062-.389-2.181-.586-3.325-.586z"/></g><g><path d="m32.054 58.975c-.001 0-.001 0-.002 0-5.545 0-11.055-1.717-15.514-4.838-7.679-5.371-12.079-14.522-11.484-23.877.59-9.262 6.059-17.732 14.271-22.105 3.842-2.047 8.219-3.129 12.656-3.129 5.03 0 9.91 1.363 14.114 3.941 7.96 4.881 12.904 13.707 12.904 23.033 0 1.15-.073 2.311-.219 3.451-1.171 9.176-7.141 17.27-15.58 21.123-3.441 1.571-7.296 2.401-11.146 2.401zm-.074-51.95c-4.111 0-8.163 1.002-11.717 2.895-7.604 4.049-12.667 11.893-13.213 20.467-.551 8.664 3.524 17.137 10.635 22.111 4.126 2.887 9.229 4.477 14.368 4.477h.001c3.565 0 7.133-.768 10.316-2.221 7.814-3.568 13.342-11.061 14.426-19.557.135-1.057.203-2.131.203-3.197 0-8.635-4.579-16.809-11.949-21.328-3.89-2.385-8.408-3.647-13.07-3.647z"/></g></g></svg>
                <b class="underline">{{get_article.author|truncatechars:"20"}}</b>
                <span class="gray">{{get_article.create_date}}</span><br>
            </div>
            <a href="{% url 'forum' %}">Вернуться назад</a><br><br>
            <p><b>Название: </b>{{get_article.name}}</p>
        </div>
        <p><b>Текст:</b> {{get_article.text}}</p>
        {% if request.user.is_authenticated %}
            <p><b>Комментарии ({{get_article.comments_articles.all.count}})</b></p>
            <hr>
                {% if messages %}
            <div class="alert alert-success">
                {% for m in messages %}
                    {{m}}
                {% endfor %}
            </div>
            {% endif %}
            <ul class="comment-list">
            {% for item in get_article.comments_articles.all %}
            <li>
            {% include 'comment_item.html' %}
            </li>
            {% endfor %}
            </ul>
            <div class="col-4">
                <p><b>Добавить комментарий</b></p>
                <form action="" id="add_form" method="post">
                    {% csrf_token %}
                        {{form.as_p}}
                </form>
                <button form="add_form" type="submit" class="btn btn-primary mb-3">Отправить</button><br>
            </div>
        </div>
        {% else %}
            <br>
            <p><a href="{% url 'login_page' %}" class="mb-4">Войдите, чтобы посмотреть и написать комментарий</a></p>
        {% endif %}
{% endblock %}
{% block js %}
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    $('body').on('click', '.update_status', function(event){
        event.preventDefault();
        if (confirm('Вы уверены')) {
            var url = $(this).attr('data-url')
            var tag_li = $(this).parent()
            console.log(url)
            
            $.ajax({
                url:url,
                type: 'GET',
                success: function(response) {
                    tag_li.html(response)
                    console.log(response)
                }
            })
            
        }

    })
</script>
{% endblock %}
